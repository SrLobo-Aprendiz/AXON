| Tabla                 | Política                                        | Acción (SELECT/INSERT...) | Regla de Lectura                                                                                                                                                                                                                  | Regla de Escritura                                                                                                                                                                                                                |
| --------------------- | ----------------------------------------------- | ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| app_templates         | Allow authenticated read on app_templates       | SELECT                    | true                                                                                                                                                                                                                              | null                                                                                                                                                                                                                              |
| chat_messages         | Users can edit their own messages               | UPDATE                    | ((sender_id = auth.uid()) AND (household_id IN ( SELECT unnest(profiles.household_ids) AS unnest
   FROM profiles
  WHERE (profiles.id = auth.uid()))))                                                                           | ((sender_id = auth.uid()) AND (household_id IN ( SELECT unnest(profiles.household_ids) AS unnest
   FROM profiles
  WHERE (profiles.id = auth.uid()))))                                                                           |
| chat_messages         | Users can delete their own messages             | DELETE                    | ((sender_id = auth.uid()) AND (household_id IN ( SELECT unnest(profiles.household_ids) AS unnest
   FROM profiles
  WHERE (profiles.id = auth.uid()))))                                                                           | null                                                                                                                                                                                                                              |
| chat_messages         | Users can send messages to their families       | INSERT                    | null                                                                                                                                                                                                                              | ((household_id IN ( SELECT unnest(profiles.household_ids) AS unnest
   FROM profiles
  WHERE (profiles.id = auth.uid()))) AND (sender_id = auth.uid()))                                                                           |
| chat_messages         | Users can view messages from their families     | SELECT                    | (household_id IN ( SELECT unnest(profiles.household_ids) AS unnest
   FROM profiles
  WHERE (profiles.id = auth.uid())))                                                                                                          | null                                                                                                                                                                                                                              |
| fridge_items          | fridge_select                                   | SELECT                    | (auth.uid() IN ( SELECT household_members.user_id
   FROM household_members
  WHERE (household_members.household_id = fridge_items.household_id)))                                                                                | null                                                                                                                                                                                                                              |
| fridge_items          | fridge_delete                                   | DELETE                    | (auth.uid() IN ( SELECT household_members.user_id
   FROM household_members
  WHERE (household_members.household_id = fridge_items.household_id)))                                                                                | null                                                                                                                                                                                                                              |
| fridge_items          | fridge_insert_update                            | ALL                       | (auth.uid() IN ( SELECT household_members.user_id
   FROM household_members
  WHERE (household_members.household_id = fridge_items.household_id)))                                                                                | (auth.uid() IN ( SELECT household_members.user_id
   FROM household_members
  WHERE (household_members.household_id = fridge_items.household_id)))                                                                                |
| fridge_items          | Users can view fridge items in their families   | SELECT                    | is_family_member(household_id)                                                                                                                                                                                                    | null                                                                                                                                                                                                                              |
| fridge_items          | Users can add fridge items to their families    | INSERT                    | null                                                                                                                                                                                                                              | is_family_member(household_id)                                                                                                                                                                                                    |
| fridge_items          | Users can update fridge items in their families | UPDATE                    | is_family_member(household_id)                                                                                                                                                                                                    | null                                                                                                                                                                                                                              |
| fridge_items          | Users can delete fridge items in their families | DELETE                    | is_family_member(household_id)                                                                                                                                                                                                    | null                                                                                                                                                                                                                              |
| graffiti_layers       | Acceso graffiti_layers auth                     | ALL                       | (auth.role() = 'authenticated'::text)                                                                                                                                                                                             | null                                                                                                                                                                                                                              |
| household_members     | fix_miembros_select                             | SELECT                    | (user_id = auth.uid())                                                                                                                                                                                                            | null                                                                                                                                                                                                                              |
| household_members     | fix_miembros_insert                             | INSERT                    | null                                                                                                                                                                                                                              | (user_id = auth.uid())                                                                                                                                                                                                            |
| household_uploads     | Users can add uploads to their families         | INSERT                    | null                                                                                                                                                                                                                              | is_family_member(household_id)                                                                                                                                                                                                    |
| household_uploads     | Users can view uploads in their families        | SELECT                    | is_family_member(household_id)                                                                                                                                                                                                    | null                                                                                                                                                                                                                              |
| household_uploads     | Users can delete uploads from their families    | DELETE                    | is_family_member(household_id)                                                                                                                                                                                                    | null                                                                                                                                                                                                                              |
| households            | policy_households_insert                        | INSERT                    | null                                                                                                                                                                                                                              | (created_by = auth.uid())                                                                                                                                                                                                         |
| households            | policy_households_select                        | SELECT                    | ((created_by = auth.uid()) OR (id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid()))))                                                                        | null                                                                                                                                                                                                                              |
| households            | policy_households_update                        | UPDATE                    | ((created_by = auth.uid()) OR (id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE ((household_members.user_id = auth.uid()) AND (household_members.role = 'owner'::text)))))                         | null                                                                                                                                                                                                                              |
| households            | policy_households_delete                        | DELETE                    | (created_by = auth.uid())                                                                                                                                                                                                         | null                                                                                                                                                                                                                              |
| inventory_items       | inventory_delete_master                         | DELETE                    | (household_id IN ( SELECT households.id
   FROM households
  WHERE (households.created_by = auth.uid())
UNION
 SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid()))) | null                                                                                                                                                                                                                              |
| inventory_items       | inventory_select_master                         | SELECT                    | (household_id IN ( SELECT households.id
   FROM households
  WHERE (households.created_by = auth.uid())
UNION
 SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid()))) | null                                                                                                                                                                                                                              |
| inventory_items       | inventory_insert_master                         | INSERT                    | null                                                                                                                                                                                                                              | (household_id IN ( SELECT households.id
   FROM households
  WHERE (households.created_by = auth.uid())
UNION
 SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid()))) |
| inventory_items       | inventory_update_master                         | UPDATE                    | (household_id IN ( SELECT households.id
   FROM households
  WHERE (households.created_by = auth.uid())
UNION
 SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid()))) | null                                                                                                                                                                                                                              |
| inventory_items       | Members view items                              | SELECT                    | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             | null                                                                                                                                                                                                                              |
| inventory_items       | Members insert items                            | INSERT                    | null                                                                                                                                                                                                                              | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             |
| inventory_items       | Members update items                            | UPDATE                    | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             | null                                                                                                                                                                                                                              |
| inventory_items       | Members delete items                            | DELETE                    | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             | null                                                                                                                                                                                                                              |
| media_transfers       | Acceso media_transfers auth                     | ALL                       | (auth.role() = 'authenticated'::text)                                                                                                                                                                                             | null                                                                                                                                                                                                                              |
| pioneer_codes         | Anyone can check pioneer codes                  | SELECT                    | true                                                                                                                                                                                                                              | null                                                                                                                                                                                                                              |
| profiles              | fix_perfil_all                                  | ALL                       | (id = auth.uid())                                                                                                                                                                                                                 | (id = auth.uid())                                                                                                                                                                                                                 |
| prompt_options        | Allow authenticated read on prompt_options      | SELECT                    | true                                                                                                                                                                                                                              | null                                                                                                                                                                                                                              |
| safety_logs           | Superadmin and involved parties view logs       | SELECT                    | (is_superadmin() OR (auth.uid() = parent_id) OR (auth.uid() = child_id))                                                                                                                                                          | null                                                                                                                                                                                                                              |
| shopping_list         | Members can insert shopping list                | INSERT                    | null                                                                                                                                                                                                                              | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             |
| shopping_list         | Members can delete shopping list                | DELETE                    | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             | null                                                                                                                                                                                                                              |
| shopping_list         | Members can update shopping list                | UPDATE                    | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             | null                                                                                                                                                                                                                              |
| shopping_list         | Users can insert shopping items                 | INSERT                    | null                                                                                                                                                                                                                              | (auth.uid() IN ( SELECT household_members.user_id
   FROM household_members
  WHERE (household_members.household_id = shopping_list.household_id)))                                                                               |
| shopping_list         | Users can update shopping items                 | UPDATE                    | (auth.uid() IN ( SELECT household_members.user_id
   FROM household_members
  WHERE (household_members.household_id = shopping_list.household_id)))                                                                               | null                                                                                                                                                                                                                              |
| shopping_list         | Users can see their household shopping list     | SELECT                    | (auth.uid() IN ( SELECT household_members.user_id
   FROM household_members
  WHERE (household_members.household_id = shopping_list.household_id)))                                                                               | null                                                                                                                                                                                                                              |
| shopping_list         | Members can view shopping list                  | SELECT                    | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             | null                                                                                                                                                                                                                              |
| social_spaces         | Acceso social_spaces auth                       | ALL                       | (auth.role() = 'authenticated'::text)                                                                                                                                                                                             | null                                                                                                                                                                                                                              |
| storage_zones         | Members can manage storage zones                | ALL                       | (household_id IN ( SELECT household_members.household_id
   FROM household_members
  WHERE (household_members.user_id = auth.uid())))                                                                                             | null                                                                                                                                                                                                                              |
| user_roles_deprecated | Users can view roles in their families          | SELECT                    | is_family_member(household_id)                                                                                                                                                                                                    | null                                                                                                                                                                                                                              |
| user_roles_deprecated | Family admins can manage roles                  | INSERT                    | null                                                                                                                                                                                                                              | (has_family_role(auth.uid(), household_id, 'admin'::app_role) OR (user_id = auth.uid()))                                                                                                                                          |
| user_roles_deprecated | Family admins can delete roles                  | DELETE                    | has_family_role(auth.uid(), household_id, 'admin'::app_role)                                                                                                                                                                      | null                                                                                                                                                                                                                              |